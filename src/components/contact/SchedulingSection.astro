---
import { siteConfig } from '../../data/siteConfig';
---

<div class="rounded-xl border border-slate-200 bg-white p-6 dark:border-slate-800 dark:bg-slate-900">
  <h3 class="mb-2 text-lg font-semibold text-slate-900 dark:text-white">Schedule a Call</h3>
  <p class="mb-4 text-sm text-slate-600 dark:text-slate-400">
    Prefer to chat in real time? Book a free 30-minute discovery call to discuss your project.
  </p>
  <div id="scheduling-container" class="min-h-[100px]">
    <button
      id="load-calendly"
      type="button"
      class="inline-flex items-center gap-2 rounded-lg bg-primary-600 px-5 py-2.5 text-sm font-medium text-white transition-colors hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600"
    >
      <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
      </svg>
      Open Scheduling Calendar
    </button>
  </div>
</div>

<script define:vars={{ calendlyUrl: siteConfig.calendlyUrl }}>
  function setupScheduling() {
    const btn = document.getElementById('load-calendly');
    const container = document.getElementById('scheduling-container');
    if (!btn || !container) return;

    btn.addEventListener('click', () => {
      container.innerHTML = `<iframe src="${calendlyUrl}" width="100%" height="630" frameborder="0" loading="lazy" title="Schedule a meeting" style="border-radius: 8px;"></iframe>`;
    });
  }

  setupScheduling();
  document.addEventListener('astro:after-swap', setupScheduling);
</script>
